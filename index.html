<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BigWinner</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary: #e56b6b;
      --primary-dark: #d45a5a;
      --bg: #f5f2f2;
      --card-bg: #e56b6b;
      --text: #ffffff;
      --shadow: 0 4px 20px rgba(229, 107, 107, 0.3);
    }

    *{
      font-family: 'Inter', sans-serif;
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body{
      margin: 0;
      background: var(--bg);
      padding: 16px;
      min-height: 100vh;
    }

    /* ===== HEADER ===== */
    .topbar{
      background: var(--primary);
      color: #fff;
      padding: 16px 20px;
      border-radius: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
    }

    .brand{
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .logo{
      width: 48px;
      height: 48px;
      background: white;
      color: var(--primary);
      font-size: 24px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
    }

    #titleLink{
      font-size: 22px;
      font-weight: 800;
      cursor: pointer;
      letter-spacing: -0.5px;
    }

    /* ===== PASSWORD LOGIN ===== */
    #passwordLogin{
      background: white;
      max-width: 400px;
      margin: 40px auto;
      padding: 40px 32px;
      border-radius: 24px;
      box-shadow: var(--shadow);
      text-align: center;
    }

    #passwordLogin h2{
      font-size: 24px;
      color: #333;
      margin-bottom: 8px;
    }

    #mainPasswordInput{
      width: 100%;
      padding: 16px;
      font-size: 16px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      margin-top: 24px;
      outline: none;
    }

    #mainPasswordInput:focus{
      border-color: var(--primary);
    }

    #passwordLogin button{
      width: 100%;
      margin-top: 16px;
      padding: 16px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }

    #passwordError{
      color: #ff4757;
      margin-top: 12px;
      font-size: 14px;
      display: none;
    }

    /* ===== MEMBERS SECTION ===== */
    #membersSection{
      display: none;
    }

    .box{
      background: white;
      padding: 20px;
      border-radius: 16px;
      margin-top: 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }

    .box h2{
      font-size: 18px;
      margin-bottom: 16px;
      color: #333;
    }

    .members{
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .member-btn{
      padding: 14px;
      border-radius: 12px;
      border: 2px solid #f0f0f0;
      font-size: 15px;
      font-weight: 600;
      background: white;
      cursor: pointer;
      text-align: left;
    }

    .member-btn:hover{
      border-color: var(--primary);
      background: #fff5f5;
    }

    /* ===== USER DASHBOARD MODAL ===== */
    #userDashboardModal{
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      padding: 16px;
      overflow: auto;
      z-index: 999;
    }

    #userDashboardModal > div{
      max-width: 600px;
      margin: 20px auto;
      background: linear-gradient(180deg, #f8d7d7 0%, #f2b3b3 100%);
      border-radius: 24px;
      padding: 24px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    /* Header section */
    .dashboard-header{
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    #udName{
      font-size: 26px;
      font-weight: 800;
      color: #000;
      line-height: 1.2;
      max-width: 60%;
      word-break: break-word;
    }

    .header-actions{
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .badge{
      background: #ff4757;
      color: #fff;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
    }

    .dashboard-header button{
      background: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    /* ===== CARDS GRID ===== */
    .card-grid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }

    .card{
      background: var(--card-bg);
      color: var(--text);
      padding: 16px;
      border-radius: 16px;
      min-height: 100px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 0 4px 12px rgba(229, 107, 107, 0.2);
    }

    .card h2{
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      opacity: 0.95;
      line-height: 1.3;
      margin: 0;
    }

    .card .amount{
      font-size: 20px;
      font-weight: 700;
      margin-top: 8px;
      line-height: 1.2;
      word-break: break-word;
    }

    .card .subtext{
      font-size: 10px;
      opacity: 0.85;
      margin-top: 4px;
      font-weight: 500;
    }

    /* Full width cards */
    .card-full{
      grid-column: span 2;
      text-align: center;
      min-height: 80px;
    }

    .card-full h2{
      font-size: 12px;
    }

    .card-full .amount{
      font-size: 24px;
    }

    /* Customer Service card */
    .card-service h2{
      font-size: 12px;
    }

    .card-service p{
      font-size: 11px;
      margin-top: 8px;
      opacity: 0.9;
      line-height: 1.4;
    }

    /* ===== USER CHAT MODAL ===== */
    #userChatModal{
      display: none;
      margin-top: 16px;
    }

    .chat-box{
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }

    .chat-box h3{
      font-size: 16px;
      margin-bottom: 12px;
      color: #333;
    }

    #userChatHistory{
      max-height: 250px;
      overflow: auto;
      padding: 16px;
      background: #fafafa;
      border-radius: 12px;
      margin-bottom: 12px;
    }

    #userChatHistory p{
      background: white;
      padding: 10px 14px;
      border-radius: 12px;
      margin: 8px 0;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    #userChatHistory small{
      color: #999;
      font-size: 11px;
      display: block;
      margin-top: 4px;
    }

    .chat-input-area{
      display: flex;
      gap: 10px;
    }

    #userMsg{
      flex: 1;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
    }

    #userMsg:focus{
      border-color: var(--primary);
    }

    .chat-input-area button{
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
    }

    /* ===== ADMIN PANEL ===== */
    #adminPanel{
      display: none;
      background: white;
      padding: 24px;
      border-radius: 20px;
      margin-top: 20px;
      box-shadow: var(--shadow);
    }

    .admin-header{
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    #adminPanel h3{
      font-size: 18px;
      color: #333;
      font-weight: 700;
    }

    .admin-actions{
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .notification-bell{
      cursor: pointer;
      font-size: 24px;
      position: relative;
    }

    #adminUnreadBadge{
      position: absolute;
      top: -5px;
      right: -5px;
      display: none;
    }

    /* Form Grid */
    .form-grid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    #adminPanel input{
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e8e8e8;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
    }

    #adminPanel input:focus{
      border-color: var(--primary);
    }

    #adminPanel button{
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      margin-right: 8px;
      margin-top: 12px;
      font-size: 14px;
    }

    #userList{
      margin-top: 16px;
    }

    #adminEdit{
      background: #fafafa;
      padding: 20px;
      border-radius: 16px;
      margin-top: 16px;
      display: none;
    }

    #adminEdit h3{
      margin-bottom: 16px;
    }

    #adminEdit input{
      margin-bottom: 10px;
    }

    #adminEdit button{
      margin-top: 8px;
      margin-right: 8px;
    }

    /* ===== ADMIN CHAT ===== */
    #adminChatContainer{
      display: flex;
      gap: 16px;
      margin-top: 24px;
      background: white;
      padding: 20px;
      border-radius: 16px;
      border: 2px solid #f0f0f0;
    }

    .chat-sidebar{
      width: 35%;
      border-right: 2px solid #f0f0f0;
      padding-right: 16px;
    }

    .chat-sidebar h3{
      font-size: 16px;
      margin-bottom: 12px;
      color: #333;
    }

    #convList{
      max-height: 300px;
      overflow: auto;
    }

    .conv-btn{
      background: #fff5f5;
      padding: 12px;
      border-radius: 10px;
      margin-bottom: 8px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      border-left: 3px solid var(--primary);
    }

    .conv-btn:hover{
      background: #ffe8e8;
    }

    .chat-main{
      width: 65%;
      padding-left: 16px;
    }

    #chatWith{
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #333;
    }

    #noConversation{
      padding: 40px;
      text-align: center;
      color: #999;
      font-size: 14px;
    }

    #chatPanel{
      display: none;
    }

    #chatHistory{
      height: 280px;
      overflow: auto;
      background: #fafafa;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 12px;
    }

    #chatHistory p{
      background: white;
      padding: 10px 14px;
      border-radius: 12px;
      margin: 8px 0;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    #chatHistory small{
      color: #999;
      font-size: 11px;
      display: block;
      margin-top: 4px;
    }

    .reply-area{
      display: flex;
      gap: 10px;
    }

    #replyText{
      flex: 1;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
    }

    #replyText:focus{
      border-color: var(--primary);
    }

    .reply-area button{
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
    }

    /* ===== NOTIFICATION MODAL ===== */
    #notifyModal{
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      padding: 20px;
      z-index: 9999;
    }

    .modal-content{
      max-width: 500px;
      margin: 40px auto;
      background: white;
      padding: 24px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .modal-content h2{
      font-size: 20px;
      margin-bottom: 16px;
      color: #333;
    }

    #notifyList{
      max-height: 300px;
      overflow: auto;
    }

    .notify-item{
      padding: 14px;
      background: #fff5f5;
      border-radius: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      font-size: 14px;
    }

    .notify-item:hover{
      background: #ffe8e8;
    }

    .notify-item b{
      color: var(--primary);
    }

    .modal-content button{
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 16px;
      font-size: 14px;
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 600px){
      body{
        padding: 12px;
      }

      #passwordLogin{
        margin: 20px auto;
        padding: 32px 24px;
      }

      .card-grid{
        gap: 10px;
      }

      .card{
        padding: 14px;
        min-height: 90px;
        border-radius: 14px;
      }

      .card h2{
        font-size: 10px;
      }

      .card .amount{
        font-size: 18px;
      }

      .card .subtext{
        font-size: 9px;
      }

      #udName{
        font-size: 20px;
      }

      .form-grid{
        grid-template-columns: 1fr;
      }

      #adminChatContainer{
        flex-direction: column;
      }

      .chat-sidebar,
      .chat-main{
        width: 100%;
        padding: 0;
        border: none;
      }

      .chat-sidebar{
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 16px;
        margin-bottom: 16px;
      }

      #convList{
        max-height: 150px;
      }
    }
  </style>
</head>

<body>

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="brand">
      <div class="logo">B</div>
      <div>
        <div id="titleLink" style="font-size:22px;font-weight:800;cursor:pointer;">BIGWINNER</div>
        <div style="font-size:12px;">EVERYONE MAKES MONEY</div>
      </div>
    </div>
    <div id="adminNotifyWrap"></div>
  </div>

  <!-- PASSWORD LOGIN SECTION -->
  <div id="passwordLogin">
    <h2>Enter Password</h2>
    <input type="password" id="mainPasswordInput" placeholder="Enter your password">
    <button onclick="checkPassword()">Login</button>
    <p id="passwordError">Wrong password!</p>
  </div>

  <!-- PUBLIC USER LIST - Hidden -->
  <div id="membersSection" class="box">
    <h2>Members</h2>
    <div class="members" id="publicList"></div>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel">
    <div class="admin-header">
      <h3>Add Member</h3>
      <div class="admin-actions">
        <div class="notification-bell" onclick="openNotifications()">
          ðŸ””
          <span id="adminUnreadBadge" class="badge">0</span>
        </div>
      </div>
    </div>

    <div class="form-grid">
      <input id="newUser" placeholder="Username">
      <input id="acc" placeholder="Account No">
      <input id="ifsc" placeholder="IFSC">
      <input id="userPass" placeholder="Set User Password">
      <input id="commission" placeholder="Commission %">
      <input id="teamPeopleInput" placeholder="Team People">
      <input id="teamWorkerInput" placeholder="Team Worker">
      <input id="tIncome" placeholder="Today Income">
      <input id="yIncome" placeholder="Yesterday Income">
      <input id="turnover" placeholder="Today Turnover">
      <input id="turnoverYesterday" placeholder="Yesterday Turnover">
      <input id="wageOwn" placeholder="Total Withdrawal">
      <input id="wageTeam" placeholder="Security Deposit">
      <input id="wallet" placeholder="Wallet">
      <input id="totalTrans" placeholder="Total Transaction">
    </div>

    <button onclick="addMember()">Add</button>
    <button onclick="loadAdminList()">Refresh</button>
    <button onclick="logoutAdmin()">Logout</button>

    <h3 style="margin-top:24px;">All Members</h3>
    <div id="userList"></div>
    <div id="adminEdit"></div>

    <!-- ADMIN CHAT UI -->
    <div id="adminChatContainer" hidden>
      <div class="chat-sidebar">
        <h3>Conversations</h3>
        <div id="convList"></div>
      </div>

      <div class="chat-main">
        <div id="noConversation">Select a conversation to reply.</div>
        <div id="chatPanel">
          <div id="chatWith">Chat</div>
          <div id="chatHistory"></div>
          <div class="reply-area">
            <input id="replyText" placeholder="Type reply...">
            <button onclick="sendReply()">Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- USER DASHBOARD -->
  <div id="userDashboardModal">
    <div>
      <div class="dashboard-header">
        <h1 id="udName">User</h1>
        <div class="header-actions">
          <span id="userReplyBadge" class="badge" style="display:none;">0</span>
          <button onclick="closeUserDashboard()">Close</button>
        </div>
      </div>

      <!-- Commission + Customer Service -->
      <div class="card-grid">
        <div class="card">
          <h2>Commission</h2>
          <div class="amount" id="udCommission">0%</div>
        </div>

        <div class="card card-service" onclick="openChatUser()" style="cursor:pointer;">
          <h2>Customer Service</h2>
          <p>Tap to chat with admin</p>
        </div>
      </div>

      <!-- Today Income + Today Turnover -->
      <div class="card-grid">
        <div class="card">
          <h2>Today Income</h2>
          <div class="amount" id="udIncome">â‚¹0.00</div>
          <div class="subtext" id="udIncomeY">â‚¹0.00 yesterday</div>
        </div>

        <div class="card">
          <h2>Today Turnover</h2>
          <div class="amount" id="udTurn">â‚¹0.00</div>
          <div class="subtext" id="udTurnY">â‚¹0.00 yesterday</div>
        </div>
      </div>

      <!-- Withdrawal + Security -->
      <div class="card-grid">
        <div class="card">
          <h2>Total Withdrawal</h2>
          <div class="amount" id="udWageOwn">â‚¹0.00</div>
        </div>

        <div class="card">
          <h2>Security Deposit</h2>
          <div class="amount" id="udWageTeam">â‚¹0.00</div>
        </div>
      </div>

      <!-- Wallet Balance -->
      <div class="card-grid">
        <div class="card card-full">
          <h2>Wallet Balance</h2>
          <div class="amount" id="udWallet">â‚¹0.00</div>
        </div>
      </div>

      <!-- Total Transaction -->
      <div class="card-grid">
        <div class="card card-full">
          <h2>Total Transaction</h2>
          <div class="amount" id="udTrans">â‚¹0.00</div>
        </div>
      </div>

      <!-- USER CHAT -->
      <div id="userChatModal">
        <div class="chat-box">
          <h3>Support Chat</h3>
          <div id="userChatHistory"></div>
          <div class="chat-input-area">
            <input id="userMsg" placeholder="Type message...">
            <button onclick="userSendMessage()">Send</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- NOTIFICATION MODAL -->
  <div id="notifyModal">
    <div class="modal-content">
      <h2>Notifications</h2>
      <div id="notifyList"></div>
      <button onclick="closeNotifications()">Close</button>
    </div>
  </div>

  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <!-- JS FILE -->
  <script src="app.js"></script>
</body>
</html>
